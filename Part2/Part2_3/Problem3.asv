clear
close all
clc

%% Parameters
Ap = [-0.2 0; 1 0];
Bp = [1; 0];
Cp = [1 0.1];
Dp = 1;
a = 0;

tspan = [0 50];
x0 = [0 0 0]';

%% b
r = 1;
d = 0;

options = odeset('RelTol',1e-3,'AbsTol',1e-3);
[t,x] = ode45(@(t,y) fun3(t,y,Ap,Bp,Cp,Dp,a,r,d), tspan, x0, options);

figure
subplot(3,1,1)
plot(t,x(:,1)); grid on
xlabel('x')
subplot(3,1,2)
plot(t,x(:,2)); grid on
subplot(3,1,3)
plot(t,x(:,3)); grid on